@{
    ViewData["Title"] = "Search For User";
}


<div class="input-group">
    <input type="text" id="input_usersearch" class="form-control" placeholder="Söka användare">
    <div class="input-group-append">
        <button id="search_button" class="btn btn-secondary" type="button">
            <i class="fas fa-search"></i>
        </button>
    </div>

</div>
<ul id="search_results">
</ul>

<div id="page_search">
    <div class="search-container p-5 container">
        <div class="card justify-content-center" style="width: 25rem;">
            <img src="favicon.ico" class="card-img-top" alt="...">
            <div class="card-body">
                <h5 class="card-title">Tindra</h5>
            </div>
            <ul class="list-group list-group-flush">
                <li class="list-group-item">27 år</li>
                <li class="list-group-item">Södermanland</li>
                <li class="list-group-item">Kvinna</li>
            </ul>
            <div class="card-body">
                <a href="#" class="card-link">Matcha</a>
            </div>
        </div>
    </div>
</div>

@*event handdler to a button and fetch back  the searched string*@
<script>
    var searchButton = document.querySelector('#search_button')
    var inputUserSearch = document.querySelector('#input_usersearch')
    var searchResults = document.querySelector('#search_results')

    var displayArray = function (arr) {
        console.log(arr)

        arr.map(item => {
            var li = document.createElement('li')
            var span = document.createElement('span')
            span.innerText = `${item.firstname} ${item.surname}, ${moment().diff(item.age, 'years')} år`
            li.append(span)
            searchResults.append(li)
        })
    }

    searchButton.addEventListener('click', (ev) => {

        fetch('/api/search?q=' + inputUserSearch.value, {
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            method: "GET"
        })
            .then(res => res.json())
            .then(json => displayArray(json))
            .catch(err => console.error(err))
    })

</script>
